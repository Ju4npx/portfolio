---
import { Button } from "@/components";
import { PROJECTS } from "@/data";
import { GithubIcon, LinkIcon, ProjectIcon } from "@/icons";
import { Layout } from "@/layouts";
import { Navbar } from "@/sections";

export function getStaticPaths() {
  return PROJECTS.map((project) => ({
    params: {
      slug: project.slug,
    },
  }));
}

const { slug } = Astro.params;
const [project] = PROJECTS.filter((project) => project.slug == slug);

if (!project) {
  return new Response(JSON.stringify("Project not found"), { status: 404 });
}
---

<Layout title={`Juan Pablo Machado - ${project.name}`}>
  <Navbar />
  <article
    id="project"
    class="flex items-center justify-center shadow-inner shadow-black/75"
  >
    <div class="m-auto grid max-w-6xl gap-8 px-4 py-16 md:grid-cols-2">
      <div class="flex items-center justify-center">
        <figure class="glow-shift">
          <img
            alt={`Mockup de ${project.name}`}
            src={`/assets/images/projects/${project.image}`}
            class="aspect-video rounded-xl ring-1 ring-white/25"
            transition:name={`project-image-${project.slug}`}
          />
        </figure>
      </div>
      <div class="flex flex-col justify-center">
        <ul class="flex flex-wrap gap-2">
          {
            project.tags.map((tag) => (
              <li class="rounded-lg bg-dark px-2 text-sm text-white">{tag}</li>
            ))
          }
        </ul>
        <span class="my-4 flex items-center gap-4 text-white">
          <ProjectIcon class="size-7" />
          <h1 class="text-start text-3xl font-bold text-white md:text-4xl">
            {project.name}
          </h1>
        </span>
        <p class="text-white/75">
          {project.description}
        </p>

        <nav class="mt-4">
          <ul class="flex gap-2">
            {
              project.page && (
                <li class="relative flex">
                  <Button
                    href={project.page}
                    target="_blank"
                    variant="gradient"
                  >
                    <LinkIcon class="size-5 text-white" />
                    View page
                  </Button>
                </li>
              )
            }
            {
              project.repository && (
                <li class="flex">
                  <Button
                    href={project.repository}
                    target="_blank"
                    title="Github"
                  >
                    <GithubIcon class="size-5 text-white" />
                    View repository
                  </Button>
                </li>
              )
            }
          </ul>
        </nav>
      </div>
    </div>
  </article>
</Layout>

<style>
  #project {
    position: relative;
    min-height: calc(100vh - 80px);
  }

  #project::before,
  #project::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
  }

  #project::before {
    background: radial-gradient(
      50% 50% at 50% 50%,
      var(--color-primary-transparent) 20%,
      transparent 100%
    );
    animation: fadeAndShrink 3s ease-in-out infinite alternate;
  }

  #project::after {
    background: radial-gradient(
      50% 50% at 50% 50%,
      var(--color-secondary-transparent) 20%,
      transparent 100%
    );
    animation: fadeAndGrow 3s ease-in-out infinite alternate;
  }
</style>
